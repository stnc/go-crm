<script type="text/javascript">
    var options1 = {
        ajax: {
            url: '/admin/kisiler/kisiAra',
            type: 'POST',
            dataType: 'json',
            data: {
                q: "{{ '{{{q}}}' }}",
                _csrf: '{{ csrf }}',
            }
        },
        locale: {
            emptyTitle: 'Aranacak kişiyi yazınız',
            currentlySelected: 'Seçilen Kişi ',
            errorText: 'Veri yok',
            searchPlaceholder: 'Kişi Ara',
            statusInitialized: 'Arama yapılacak kişiyi yazınız <br> <a href="#" onclick="kisiEkleAjaxRequest(event, 1)">Yeni Kişi Eklemek İçin Tıklayın</a>',
            statusNoResults: 'Bulunamadı <a href="#" onclick="kisiEkleAjaxRequest(event, 1)">Yeni Kişi Eklemek İçin Tıklayın</a>',
            statusSearching: 'Aranıyor....',
            statusTooShort: 'Çok kısa kelime....',

        },
        log: 0,
        preprocessData: function (data) {
            var i, l = data.length,
                array = [];
            if (l) {
                for (i = 0; i < l; i++) {
                    array.push($.extend(true, data[i], {
                        text: data[i].adSoyad + ' Telefon:' + data[i].tel,
                        value: data[i].id,
                        data: {
                            subtext: 'Telefon:' + data[i].tel,
                        }
                    }));
                }
            }
            return array;
        },

    };

    var options2 = {
        ajax: {
            url: '/admin/kisiler/kisiAra',
            type: 'POST',
            dataType: 'json',
            data: {
                q: "{{ '{{{q}}}' }}",
                _csrf: '{{ csrf }}',
            }
        },
        locale: {
            emptyTitle: 'Aranacak kişiyi yazınız',
            currentlySelected: 'Seçilen Kişi',
            errorText: 'Veri yok',
            searchPlaceholder: 'Kişi Ara',
            statusInitialized: 'Arama yapılacak kişiyi yazınız <br> <a href="#" onclick="kisiEkleAjaxRequest(event, 2)">Yeni Kişi Eklemek İçin Tıklayın</a>',
            statusNoResults: 'Bulunamadı <a href="#" onclick="kisiEkleAjaxRequest(event, 2)">Yeni Kişi Eklemek İçin Tıklayın</a>',
            statusSearching: 'Aranıyor....',
            statusTooShort: 'Çok kısa kelime....',

        },
        log: 0,
        preprocessData: function (data) {
            var i, l = data.length,
                array = [];
            if (l) {
                for (i = 0; i < l; i++) {
                    array.push($.extend(true, data[i], {
                        text: data[i].adSoyad + ' Telefon:' + data[i].tel,
                        value: data[i].id,
                        data: {
                            subtext: 'Telefon:' + data[i].tel,
                        }
                    }));
                }
            }
            return array;
        },

    };

    var options3 = {
        ajax: {
            url: '/admin/kisiler/kisiAra',
            type: 'POST',
            dataType: 'json',
            data: {
                q: "{{ '{{{q}}}' }}",
                _csrf: '{{ csrf }}',
            }
        },
        locale: {
            emptyTitle: 'Aranacak kişiyi yazınız',
            currentlySelected: 'Seçilen Kişi',
            errorText: 'Veri yok',
            searchPlaceholder: 'Kişi Ara',
            statusInitialized: 'Arama yapılacak kişiyi yazınız <br> <a href="#" onclick="kisiEkleAjaxRequest(event, 3)">Yeni Kişi Eklemek İçin Tıklayın</a>',
            statusNoResults: 'Bulunamadı <a href="#" onclick="kisiEkleAjaxRequest(event, 3)">Yeni Kişi Eklemek İçin Tıklayın</a>',
            statusSearching: 'Aranıyor....',
            statusTooShort: 'Çok kısa kelime....',

        },
        log: 0,
        preprocessData: function (data) {
            var i, l = data.length,
                array = [];
            if (l) {
                for (i = 0; i < l; i++) {
                    array.push($.extend(true, data[i], {
                        text: data[i].adSoyad + ' Telefon:' + data[i].tel,
                        value: data[i].id,
                        data: {
                            subtext: 'Telefon:' + data[i].tel,
                        }
                    }));
                }
            }
            return array;
        },

    };



    $('.selectpicker1').selectpicker().filter('.with-ajax').ajaxSelectPicker(options1);
    $('.selectpicker2').selectpicker().filter('.with-ajax').ajaxSelectPicker(options2);
    $('.selectpicker3').selectpicker().filter('.with-ajax').ajaxSelectPicker(options3);

    // $(document).ready(function () {
    //     $('.fa-cloud' ).on( "click",   function(e) { ajaxDemo(e)} );
    //  });

    function kisiEkleAjaxRequest(e, val) {
        e = e || window.event;
        e.preventDefault();
        metin=$("#gr-Kisi"+val+" input").val();
        var title = 'Kişi Ekleme';
        var pars = Math.floor((Math.random() * 7) + 1);
        var params = {
            buttons: [{
                text: 'Kapat',
                close: true,
                style: 'danger'
            },
                //  { text: 'New content', close: false, style: 'success', click: kisiEkleAjaxRequest }
            ],
            size: eModal.size.lg,
            title: title,
            url: '/admin/kurban/referansCreateModalBox/' + val +"?metin="+metin
        };

        return eModal
            .ajax(params)
            .then(Telefon());
    }

    function odemeEkleAjaxRequest(e, id) {
        e = e || window.event;
        e.preventDefault();
        var title = 'Ödeme Ekleme';
        var pars = Math.floor((Math.random() * 7) + 1);
        var params = {
            buttons: [{
                text: 'Kapat',
                close: true,
                style: 'danger'
            },],
            size: eModal.size.lg,
            title: title,
            type: "get",
            data: {
                kurbanID: id,
            },
            url: '/admin/kurban/odemeEkleCreateModalBox'
        };

        return eModal
            .ajax(params)
            .then(Telefon());
    }



    function Telefon() {
        setTimeout(function () {
            $('.Telefon').mask("0000 000 0000", {
                placeholder: "____ ___-____"
            }).change()
        }, 500);
    }


    $(function () { //shorthand document.ready function

        $('#Telefon').mask("0000 000 0000", {
            placeholder: "____ ___-____"
        }) //    $('.phone_with_ddd').mask('(00) 0000-0000');


        // $('#KurbanFiyati').mask('###0.00', {
        //     reverse: true
        // }); //#.##0.00 eskisi 



        // $('.odemelerList').mask('###0.00', {
        //     reverse: true
        // });

        // $('.formatlaDecimal').mask('###0.00', {
        //     reverse: true
        // });


        // //modal sayfası için 
        // $('#VerilenUcret').mask('###0.00', {
        //     reverse: true
        // }); //#.##0.00 eskisi 



        $(document).on('submit', 'form#personAdd', function (e) {
            var validator = $("#personAdd").validate({
                errorClass: "error is-invalid",
                validClass: "valid success-alert"
            });
            validator.form();

            if (validator) {

                var form = $(this);
                var url = form.attr('action');

                $.ajax({
                    type: "POST",
                    url: url,
                    data: form.serialize(),
                    dataType: 'json',
                    success: function (data) {
                        if (data.status == "ok") {
                            eModal.close();
                            $(".gr-Kisi" + data.viewID + " .filter-option-inner-inner").text(data.username + ' Tel:' + data.tel);

                            $("select.selectpicker" + data.viewID + ".with-ajax.form-control ").html("<option value=" + data.lastID + ">" + data.username + "</option>");
                        }
                    },
                });
            }

            e.preventDefault();

            return false;

        });



        $(document).on('submit', 'form#taksitOde', function (e) {
            let frm = $('form#taksitOde');

            e.preventDefault();

            $.ajax({
                type: frm.attr('method'),
                url: frm.attr('action'),
                data: frm.serialize(),
                success: function (data) {


                    if (data.status == "err" && data.err == "büyük data") {
                        var newLine = "\r\n"
                        alert("Eklediğiniz fiyat çok fazla, ekleyebileceğiniz maksimum fiyat " + newLine + data.errMsg + ' TL')
                    }

                    if (data.status == "err" && data.err == "fk") {
                        var newLine = "\r\n"
                        alert("Beklenmeyen bir sorun oluştu")
                    }

                    if (data.status == "ok") {
                        window.location.replace(data.path);

                    }

                },
                error: function (data) {
                    console.log('An error occurred.');
                    console.log(data);
                },
            });
        });


    });

    //$(window).on('focus', function () {
        // Append this text to the `body` element.
    //    $('body').append('The window has focus.<br>');
   //     $('.bs-searchbox input').append('The window has focus.<br>');
   //   });
     /* 
      $(document).on('click', '.dropdown-toggle', function (e) {

       alert ("ewe")
        setTimeout(function() {
            $(".bs-searchbox input").focus();
        }, 250);
    });
*/
    $('.kisiKaldir').click(function(){
        let idAdres = $(this).data('id');
        $(".selectpicker"+idAdres).val(0).selectpicker("refresh");
    });

    //  $(document).ready(function() {
    //       $("#personAdd").validate();

    //    });
</script>